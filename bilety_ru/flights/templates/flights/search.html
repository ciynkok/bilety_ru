{% extends 'user_management/base.html'%}
{% load static %}

{% block head %}
<!--<link rel="stylesheet" type="text/css" href="{% static 'flights/style.css' %}">-->
<!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"-->
<!--      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">-->
{% endblock %}

{% block container %}
<form method="post" id="cityForm">
    {% csrf_token %}
    <div>
        {{ form.currencyCode.label }}:
        {{ form.currencyCode }}
    </div>
    <div class="autocomplete">
        {{ form.originLocationCode.label }}:
        {{ form.originLocationCode }}
<!--        <input type="text" id="originCity" placeholder="Введите город отправления...">-->
        <div id="originList" class="autocomplete-items"></div>
    </div>
    <div class="autocomplete">
        {{ form.destinationLocationCode.label }}:
        {{ form.destinationLocationCode }}
<!--        <input type="text" id="destinationCity" placeholder="Введите город прибытия...">-->
        <div id="destinationList" class="autocomplete-items"></div>
    </div>
    <div>
        {{ form.departureDate.label }}:
        {{ form.departureDate }}
    </div>
    <div>
        {{ form.returnDate.label }}:
        {{ form.returnDate }}
    </div>
    <div>
        {{ form.adults.label }}:
        {{ form.adults }}
    </div>
    <button type="submit" class="btn">Найти</button>
<!--    {{ form.as_p }}-->
</form>
<p>
    {{ form_data }}
</p>
<!--<script>-->
<!--document.addEventListener('DOMContentLoaded', func_list('id_originLocationCode', 'originList'));-->
<!--document.addEventListener('DOMContentLoaded', func_list('id_destinationLocationCode', 'destinationList'));-->
<!--function func_list(id_input, id_list) {-->
<!--    const input = document.getElementById(id_input);-->
<!--    const autocompleteList = document.getElementById(id_list);-->
<!--    let currentFocus = -1;-->

<!--    input.addEventListener('input', function(e) {-->
<!--        const query = e.target.value;-->

<!--        if (query.length < 2) {-->
<!--            closeAllLists();-->
<!--            return;-->
<!--        }-->

<!--        fetch(`/api_airport_search/?query=${encodeURIComponent(query)}`)-->
<!--            .then(response => response.json())-->
<!--            .then(data => {-->
<!--                showSuggestions(data);-->
<!--            });-->
<!--    });-->

<!--    input.addEventListener('keydown', function(e) {-->
<!--        const items = autocompleteList.getElementsByTagName('div');-->

<!--        if (e.keyCode === 40) {-->
<!--            currentFocus++;-->
<!--            addActive(items);-->
<!--        } else if (e.keyCode === 38) {-->
<!--            currentFocus&#45;&#45;;-->
<!--            addActive(items);-->
<!--        } else if (e.keyCode === 13) { // Enter-->
<!--            e.preventDefault();-->
<!--            if (currentFocus > -1) {-->
<!--                if (items) items[currentFocus].click();-->
<!--            }-->
<!--        }-->
<!--    });-->

<!--    function showSuggestions(items) {-->
<!--        closeAllLists();-->
<!--        currentFocus = -1;-->

<!--        if (!items || items.length === 0) return;-->

<!--        items.forEach(item => {-->
<!--            const itemElement = document.createElement('div');-->
<!--            itemElement.innerHTML = `<strong>${item.substr(0, input.value.length)}</strong>${item.substr(input.value.length)}`;-->
<!--            itemElement.innerHTML += `<input type='hidden' value='${item}'>`;-->

<!--            itemElement.addEventListener('click', function() {-->
<!--                input.value = this.getElementsByTagName('input')[0].value;-->
<!--                closeAllLists();-->
<!--            });-->

<!--            autocompleteList.appendChild(itemElement);-->
<!--        });-->
<!--    }-->

<!--    function addActive(items) {-->
<!--        if (!items) return false;-->

<!--        removeActive(items);-->

<!--        if (currentFocus >= items.length) currentFocus = 0;-->
<!--        if (currentFocus < 0) currentFocus = (items.length - 1);-->

<!--        items[currentFocus].classList.add('autocomplete-active');-->
<!--    }-->

<!--    function removeActive(items) {-->
<!--        for (let i = 0; i < items.length; i++) {-->
<!--            items[i].classList.remove('autocomplete-active');-->
<!--        }-->
<!--    }-->

<!--    function closeAllLists() {-->
<!--        const items = autocompleteList.getElementsByTagName('div');-->
<!--        for (let i = 0; i < items.length; i++) {-->
<!--            items[i].parentNode.removeChild(items[i]);-->
<!--        }-->
<!--    }-->

<!--    document.addEventListener('click', function(e) {-->
<!--        if (e.target !== input) {-->
<!--            closeAllLists();-->
<!--        }-->
<!--    });-->

<!--}-->
<!--</script>-->
<script src="{% static 'flights/search.js' %}"></script>
<!--<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"-->
<!--        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"-->
<!--        crossorigin="anonymous"></script>-->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"-->
<!--        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"-->
<!--        crossorigin="anonymous"></script>-->
<!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"-->
<!--        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"-->
<!--        crossorigin="anonymous"></script>-->
{% endblock %}

{% block body %}

<!--<div class="row pt-5">-->
<!--    <div class="col-md-6">-->
<!--    <div class="col-md-12 offset-1">-->
<!--        {% if response %}-->
<!--            <h3 class="login-heading mb-4 text-left">Available flights</h3>-->
<!--            {% for r, flight in response %}-->
<!--                {% if r.0firstFlightDepartureDate %}-->
<!--                    <div class="card mb-3 text-center" style="max-width: 40rem;">-->
<!--                        <div class="nounderline card-header text-center" style="font-size: 26;color: darkred;">${{ r.price }}</div>-->
<!--                        <div class="card-body">-->
<!--                            <div class="card-text">-->
<!--                                <h4 class="font-weight-light text-info pb-3">Departure <span class="smallstyle">Total duration {{ r.0FlightTotalDuration }}</span></h4>-->
<!--                                    <h4><img src={{ r.firstFlightAirlineLogo }} alt={{ r.firstFlightAirline }}> {{ r.0firstFlightDepartureDate }} {{ r.0firstFlightDepartureAirport }}-->
<!--                                        <a href="#" data-toggle="tooltip" class="nounderline text-info" title={{ r.0firstFlightArrivalDuration }} duration>&#10230</a> {{ r.0firstFlightArrivalAirport }} {{ r.0firstFlightArrivalDate }}</h4>-->
<!--                                    {% if r.0secondFlightDepartureAirport %}-->
<!--                                        <p class="nounderline elegantstyle">Connection duration is {{ r.0stop_time }}</p>-->
<!--                                        <h4><img src={{ r.secondFlightAirlineLogo }} alt={{ r.secondFlightAirline }}> {{ r.0secondFlightDepartureDate }} {{ r.0secondFlightDepartureAirport }}-->
<!--                                            <a href="#" data-toggle="tooltip" class="nounderline text-info" title={{ r.0secondFlightArrivalDuration }} duration>&#10230</a> {{ r.0secondFlightArrivalAirport }} {{ r.0secondFlightArrivalDate }}</h4>-->
<!--                                    {% endif %}-->
<!--                                    {% if r.1firstFlightDepartureAirport %}-->
<!--                                <hr class="newstyle">-->
<!--                                <h4 class="font-weight-light text-info pb-3">Return <span class="" style="color: black; font-size: 15px;">Total duration {{ r.1FlightTotalDuration }}</span></h4>-->
<!--                                        <h4><img src={{ r.1firstFlightAirlineLogo }} alt={{ r.1firstFlightAirline }}> {{ r.1firstFlightDepartureDate }} {{ r.1firstFlightDepartureAirport }}-->
<!--                                            <a href="#" data-toggle="tooltip" class="nounderline text-info" title={{ r.1firstFlightArrivalDuration }} duration>&#10230</a> {{ r.1firstFlightArrivalAirport }} {{ r.1firstFlightArrivalDate }}</h4>-->
<!--                                        {% if r.1secondFlightDepartureAirport %}-->
<!--                                            <p class="nounderline elegantstyle">Connection duration is {{ r.1stop_time }}</p>-->
<!--                                            <h4><img src={{ r.1secondFlightAirlineLogo }} alt={{ r.1secondFlightAirline }}> {{ r.1secondFlightDepartureDate }} {{ r.1secondFlightDepartureAirport }}-->
<!--                                                <a href="#" data-toggle="tooltip" class="nounderline text-info" title={{ r.1secondFlightArrivalDuration }} duration>&#10230</a> {{ r.1secondFlightArrivalAirport }} {{ r.1secondFlightArrivalDate }}</h4>-->
<!--                                        {% endif %}-->
<!--                                {% endif %}-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                {% endif %}-->
<!--            {% endfor %}-->
<!--        {% else %}-->
<!--            <h4 class="login-heading mb-4 text-left">No flights found for this itinerary</h4>-->
<!--        {% endif %}-->
<!--    </div>-->
<!--  </div>-->
<!--</div>-->
{% endblock %}
